У нас есть eml файл

Погуглив, что это за разрешение, мы получаем следующее

Файлы с расширением .eml используются для хранения сообщений электронной почты в формате IMF (Internet Message Format). Формат EML широко распространен и используется для хранения и перемещения сообщений между разными почтовыми программами, такими как Mozilla Thunderbird, Mac/Apple Mail, Windows Mail и другими.

Первоначальный анализ мы можем провести с помощью этой утилиты

https://github.com/GOVCERT-LU/eml_parser

Распарсив eml, получаем json

Можно использовать https://jsonformatter.org/ для более приятного форматирования

Далее используем chatgpt, для анализа файла

Получаем следующее

Пример отчета: 
На основе предоставленного JSON-файла, вот мои наблюдения и выводы:

    1. Это JSON-объект, представляющий структурированную информацию о письме.
    2. Основные компоненты письма:
    - Заголовки (headers): Содержит информацию о дате, отправителе, получателе, теме и других метаданных.
    - Тело письма (body): Содержит HTML-контент письма, включая хеши для проверки целостности.
    3. Информация о маршруте доставки (received): Показывает историю передачи письма от отправителя до получателя. Включает IP-адреса и доменные имена серверов.
    4. Данные о отправителе:
        Отправитель: root@server-id-down
        IP-адрес отправителя: 10.10.1.6 и 127.0.0.1
    5. Получатель:
        somebody1337@x1337x.com
    6. Тема письма: "Production Server Down - Immediate Action Required"
    7. Дата отправки: 10 мая 2024 года в 13:14:58 по CET
    8. Содержимое письма представлено в формате HTML с указанием кодировки UTF-8.
    9. Письмо содержит информацию о безопасности, что подтверждается его темой и содержанием.

    В теле письма есть хеши для проверки целостности контента и доменного имени отправителя.

Хэши можно чекнуть на virustotal

Используя этот инструмент https://github.com/gr33nm0nk2802/mailMeta, мы получаем следующее

[+] SPF Records: FAIL                                                        
[+] DKIM: FAIL                                                               
[+] DMARC: FAIL 

Т.о. понимаем, что этих записей нет

X-заголовков на наличие спама не было обнаружено

Можно и нужно смотреть ip адреса на 2ip для обнаружения в спам-базах

Можно также найти существующий домен, но не всегда так везет  

Перейдем к анализу файла на гугл диске

Были использованы методы соц инженерии в письме; путем нажатия на ссылку, мы переходим на гугл диск где открывается файл с сообщением, что нас взломали

Использовалась техника MITRE ATTACK "Компрометация учетных данных" для получения доступа к информации пользователя.

Указав в сообщении, что сервер упал, злоумышленник(и) подсовывают ссылки, на которую нажимает неопытный пользователь и т.о. компроментируется учетная запись  

somebody1337@x1337x.com

Сервер server-is-down не является подлинным

python eml_extractor.py --source /home/kali/Downloads --recursive 
PROCESSING FILE "/home/kali/Downloads/email-warnings.eml"
>> No attachments found.
Done.

Вложения не были найдены

https://threatfox.abuse.ch/browse.php?search=<ip>

В базе индикаторов компроментации не было найдено этого ip

Следовательно нужно смотреть, как будет вести себя файл в sandbox
(cuckoo, malheur)



